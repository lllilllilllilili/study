## **제 11장 : CQRS**

제 11장 CQRS

## **단일 모델의 단점**

- 특정 서비스를 구현하기 위해서는 여러 애그리거트에서 데이터를 가져와야 한다.
- 페이지를 로딩이 시키는데 관련된 도메인 모델을 가져오기 때문에 쿼리를 여러번 날리게 되고 결과적으로 느려지게 된다.
- 구현의 복잡도가 존재하기 때문에 상태 변경을 위한 모델(Command)와 조회(Query)를 위한 모델을 분리하는 것이다.

## **CQRS**

- 시스템을 크게 상태를 변경하는 기능, 상태 정보를 조회하는 기능으로 나눌 수 있다.
- 단일 모델로 위 종류의 기능을 구현하면 모델이 복잡해진다.
    - 상태를 변경하는 범위, 상태를 조회하는 범위가 항상 그리고 정확하게 일치하지 않는다.
- 단일 모델을 사용할 때 발생하는 복잡도를 낮추기 위해 CQRS를 사용할 수 있다.


- CQRS(Command Query Responsibility Segregation)는 상태를 변경하는 명령(Command)과 조회(Query)를 위한 모델을 분리하는 패턴이다.
- CQRS는 도메인이 복잡할 수록 유리하다. 단일 모델에서 할 수 없는 처리 장점들이 존재한다.
- 예를 들어, 온라인 쇼핑몰에서 여러 채널에서 주문 및 판매 통계를 조회해야한다고 가정해보자.
    - JPA를 사용하고 단일 도메인 모델을 적용한다면 통계 값을 빠르게 조회하기 위해서 JPA와 관련된 여러 성능 기능을 단일 도메인 모델에 적용해야한다.
    - 이런 단일 도메인에서 CQRS를 적용하면 조회 모델과 상태를 변경하는 명령 모델을 별도로 만들기 때문에 조회 때문에 도메인이 복잡해지는 것을 예방할 수 있다. 
